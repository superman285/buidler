<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Buidler architecture | Buidler</title>
    <meta name="description" content="The extensible Solidity developer tool">
    
    
    <link rel="preload" href="/assets/css/0.styles.dbaeeaf6.css" as="style"><link rel="preload" href="/assets/js/app.c7fa6efc.js" as="script"><link rel="preload" href="/assets/js/34.1694e862.js" as="script"><link rel="prefetch" href="/assets/js/10.a06519f9.js"><link rel="prefetch" href="/assets/js/11.06e3b161.js"><link rel="prefetch" href="/assets/js/12.fdf556c3.js"><link rel="prefetch" href="/assets/js/13.d50ced3d.js"><link rel="prefetch" href="/assets/js/14.e46d37e3.js"><link rel="prefetch" href="/assets/js/15.1e2aa375.js"><link rel="prefetch" href="/assets/js/16.8436a63d.js"><link rel="prefetch" href="/assets/js/17.f54ab3c4.js"><link rel="prefetch" href="/assets/js/18.25e7f5a3.js"><link rel="prefetch" href="/assets/js/19.91b2691f.js"><link rel="prefetch" href="/assets/js/2.0f4038f2.js"><link rel="prefetch" href="/assets/js/20.d8289532.js"><link rel="prefetch" href="/assets/js/21.90a1a2f7.js"><link rel="prefetch" href="/assets/js/22.84a614f0.js"><link rel="prefetch" href="/assets/js/23.ff52837b.js"><link rel="prefetch" href="/assets/js/24.1218c3a3.js"><link rel="prefetch" href="/assets/js/25.cc0b4272.js"><link rel="prefetch" href="/assets/js/26.33cb2bdc.js"><link rel="prefetch" href="/assets/js/27.b25a9b86.js"><link rel="prefetch" href="/assets/js/28.c9e57264.js"><link rel="prefetch" href="/assets/js/29.9f296f4d.js"><link rel="prefetch" href="/assets/js/3.56846e81.js"><link rel="prefetch" href="/assets/js/30.7c30568c.js"><link rel="prefetch" href="/assets/js/31.cf7fc61d.js"><link rel="prefetch" href="/assets/js/32.45834b58.js"><link rel="prefetch" href="/assets/js/33.8efd32e4.js"><link rel="prefetch" href="/assets/js/35.c6511f4d.js"><link rel="prefetch" href="/assets/js/36.bd45631d.js"><link rel="prefetch" href="/assets/js/37.52e60a46.js"><link rel="prefetch" href="/assets/js/4.7c54d4fe.js"><link rel="prefetch" href="/assets/js/5.d23f39d6.js"><link rel="prefetch" href="/assets/js/6.04438e9a.js"><link rel="prefetch" href="/assets/js/7.d66e7b16.js"><link rel="prefetch" href="/assets/js/8.543fdb29.js"><link rel="prefetch" href="/assets/js/9.c78751c5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.dbaeeaf6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Buidler</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/documentation/" class="nav-link router-link-active">Documentation</a></div><div class="nav-item"><a href="/api/" class="nav-link">API Docs</a></div><div class="nav-item"><a href="https://nomiclabs.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nomic Labs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/nomiclabs/buidler" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/documentation/" class="nav-link router-link-active">Documentation</a></div><div class="nav-item"><a href="/api/" class="nav-link">API Docs</a></div><div class="nav-item"><a href="https://nomiclabs.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nomic Labs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/nomiclabs/buidler" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Documentation</span> <!----></p> <ul class="sidebar-group-items"></ul></div></li><li><a href="/documentation/" class="sidebar-link">Overview</a></li><li><a href="/documentation/config.html" class="sidebar-link">Buidler configuration</a></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Tutorials</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/documentation/tutorials/truffle-migration.html" class="sidebar-link">Migrating from Truffle</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Advanced topics</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/documentation/advanced/architecture.html" class="active sidebar-link">The Buidler architecture</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/advanced/architecture.html#tasks" class="sidebar-link">Tasks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/advanced/architecture.html#creating-your-own-tasks" class="sidebar-link">Creating your own tasks</a></li><li class="sidebar-sub-header"><a href="/documentation/advanced/architecture.html#overriding-tasks" class="sidebar-link">Overriding tasks</a></li><li class="sidebar-sub-header"><a href="/documentation/advanced/architecture.html#internal-tasks" class="sidebar-link">Internal tasks</a></li></ul></li><li class="sidebar-sub-header"><a href="/documentation/advanced/architecture.html#the-buidler-runtime-environment" class="sidebar-link">The Buidler Runtime Environment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/advanced/architecture.html#globally-exported-buidler-runtime-environment" class="sidebar-link">Globally exported Buidler Runtime Environment</a></li><li class="sidebar-sub-header"><a href="/documentation/advanced/architecture.html#explicitly-importing-the-buidler-runtime-environment" class="sidebar-link">Explicitly importing the Buidler Runtime Environment</a></li><li class="sidebar-sub-header"><a href="/documentation/advanced/architecture.html#extending-the-buidler-runtime-environment" class="sidebar-link">Extending the Buidler Runtime Environment</a></li><li class="sidebar-sub-header"><a href="/documentation/advanced/architecture.html#accessing-the-buidler-runtime-environment-from-outside-a-task" class="sidebar-link">Accessing the Buidler Runtime Environment from outside a task</a></li></ul></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="the-buidler-architecture"><a href="#the-buidler-architecture" aria-hidden="true" class="header-anchor">#</a> The Buidler architecture</h1> <p>Buidler is designed around the concepts of tasks, and the Buidler Runtime Environment, a set of functionality available for tasks. This document describes both concepts in detail.</p> <p><strong>You don't need to read this to use Buidler, you can get started with it by reading <a href="https://medium.com/nomic-labs-blog/how-to-get-started-with-buidler-68beb6b9bb04" target="_blank" rel="noopener noreferrer">this guide<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</strong></p> <p>If you want to write your own tasks, create your own plugins, or are just curious about Buidler internals, keep reading.</p> <h2 id="tasks"><a href="#tasks" aria-hidden="true" class="header-anchor">#</a> Tasks</h2> <p>Buidler helps smart contract developers automate their workflow by letting them run and create tasks. Tasks can call other tasks, so complex workflows can be defined. Users and plugins can override existing tasks, making those workflows customizable and extendable.</p> <p>A task is a javascript async function with some associated metadata. This metadata is used by Buidler to automate some things for you. Arguments parsing, validation, and help messages are taken care of.</p> <h3 id="creating-your-own-tasks"><a href="#creating-your-own-tasks" aria-hidden="true" class="header-anchor">#</a> Creating your own tasks</h3> <p>You can create your own tasks in your <code>buidler.config.js</code> file. The <a href>Config DSL</a> will be available in the global environment, with functions for defining tasks. You can also import the DSL with <code>require(&quot;@nomiclabs/buidler/config&quot;)</code> if you prefer to keep things explicit, and take advantage of your editor's autocomplete.</p> <p>Creating a task is done by calling the <a href><code>task</code> function</a>. It will return a <a href><code>TaskDefinition</code></a> object, which can be used to [define the task's parameters]. There are multiple ways of calling <code>task</code>, we read about all of them, take a look at <a href>its API documentation</a>.</p> <p>The simplest task you can define is</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">task</span><span class="token punctuation">(</span>
  <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Prints 'Hello, World!'&quot;</span><span class="token punctuation">,</span> 
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">action</span><span class="token punctuation">(</span>taskArguments<span class="token punctuation">,</span> env<span class="token punctuation">,</span> runSuper<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello, World!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>task</code>'s first argument is the task name. The second one is its description, which is used for printing help messages in the CLI. The third one, action, is an async function that receives the following arguments:</p> <p><code>taskArguments</code> is an object with the parsed CLI arguments of the task. In this case, it's an empty object.
<code>env</code> is the <a href>Buidler Runtime Environment</a>.
<a href><code>runSuper</code></a> is only relevant if you are overriding an existing task. It lets you run the original task's action.
Defining the action's arguments is optional. The Buidler Runtime Environment and <code>runSuper</code> will also be available in the global scope. We can rewrite our &quot;hello&quot; task this way:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Prints 'Hello, World!'&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello, World!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="tasks-actions-requirements"><a href="#tasks-actions-requirements" aria-hidden="true" class="header-anchor">#</a> Tasks' actions requirements</h4> <p>The only requirement for writing a task is that the <code>Promise</code> returned by its action must not resolve before every async process it started is finished.</p> <p>This is an example of a task whose action doesn't meet this requirement.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;BAD&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;This task is broken&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
      <span class="token string">&quot;This tasks' action returned a promise that resolved before I was thrown&quot;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This other task uses a <code>Promise</code> to wait for the timeout to fire.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;delayed-hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Prints 'Hello, World!' after a second&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello, World!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Manually creating a <code>Promise</code> can look challenging, but you don't have to do that if you stick to <code>async</code>/<code>await</code> and <code>Promise</code>-based APIs. For example, you can use the npm package <a href="https://www.npmjs.com/package/delay" target="_blank" rel="noopener noreferrer"><code>delay</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for a promisified version of <code>setTimeout</code>.</p> <h4 id="defining-parameters"><a href="#defining-parameters" aria-hidden="true" class="header-anchor">#</a> Defining parameters</h4> <p>Buidler tasks can receive <code>--named</code> parameters with a value, <code>--flags</code>, positional and variadic parameters. Variadic parameters act like javascript's rest parameters. The <a href>Config DSL</a> <code>task</code> returns an object with methods to define all of them. Once defined, Buidler takes control of parsing, validating them, and printing help messages.</p> <p>Adding a positional parameter to the <code>hello</code> task can look like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Prints a greeting'&quot;</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">addOptionalParam</span><span class="token punctuation">(</span><span class="token string">&quot;greeting&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;The greeting to print&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> greeting <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>And would be run with <code>npx buidler hello --greeting Hola</code>.</p> <p>You can read the full documentation of these methods and their possible parameters in <a href>their API docs</a>.</p> <h5 id="positional-parameters-restrictions"><a href="#positional-parameters-restrictions" aria-hidden="true" class="header-anchor">#</a> Positional parameters restrictions</h5> <p>Positional and variadic parameters don't have to be named, and have the usual restrictions of a programming language:</p> <p>No parameter can follow a variadic one
Required/mandatory parameters can't follow an optional one.</p> <p>Failing to follow these restrictions will result in an exception being thrown when loading Buidler.</p> <h5 id="type-validations"><a href="#type-validations" aria-hidden="true" class="header-anchor">#</a> Type validations</h5> <p>Buidler solves validating and parsing the values provided for each parameter. You can declare the type of a parameter, and Buidler will get the CLI strings and convert it into your desired type. If this conversion fails, it will print an error message explaining why.</p> <p>A number of types are available in the Config DSL through a <code>types</code> object. This object is injected into the global scope before processing your <code>buidler.config.js</code>, but you can also import it with <code>const { types } = require(&quot;@nomiclabs/buidler/config&quot;)</code> and take advantage of your editor's autocomplete.</p> <p>An example of a task defining a type for one of its parameters is</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Prints 'Hello' multiple times&quot;</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">addOptionalParam</span><span class="token punctuation">(</span><span class="token string">&quot;times&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;The number of times to print 'Hello'&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> types<span class="token punctuation">.</span>int<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> times <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> times<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Calling it with <code>npx buidler hello --times notanumber</code> will result in an error.</p> <h3 id="overriding-tasks"><a href="#overriding-tasks" aria-hidden="true" class="header-anchor">#</a> Overriding tasks</h3> <p>Defining a task with the same name than an existing one will override it. This is useful to change or extend the behavior of built-in and plugin-provided tasks.</p> <p>Tasks overriding works very similarly to overriding methods when extending a class. You can set your own action, which can call the previous one. The only restriction when overriding tasks, is that you can't add or remove parameters.</p> <p>Tasks override order is important since actions can only call the immediately previous definition, using the <code>runSuper</code> function.</p> <p>Overriding built-in tasks is a great way to customize and extend Buidler. To know which tasks to override, take a look at <a href>src/builtin-tasks</a>.</p> <h4 id="the-runsuper-function"><a href="#the-runsuper-function" aria-hidden="true" class="header-anchor">#</a> The <code>runSuper</code> function</h4> <p><code>runSuper</code> is a function available to override task's actions. It can be received as the third argument of the task or used directly from the global object.</p> <p>This function works like <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/super" target="_blank" rel="noopener noreferrer">javascript's <code>super</code> keyword<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, it calls the tasks' previous action.</p> <p>The <code>runSuper</code> function receives a single optional argument, an object with the task arguments. If this argument isn't provided, the same task arguments received by the action calling it will be used.</p> <h3 id="internal-tasks"><a href="#internal-tasks" aria-hidden="true" class="header-anchor">#</a> Internal tasks</h3> <p>Creating tasks with lots of logic makes it hard to extend or customizing them. Making multiple small and focused tasks that call each other is better for that purpose. If you design your tasks in this way, users that want to change only a small aspect of them can override one of your intermediate tasks.</p> <p>For example, the <code>compile</code> task is implemented as a pipeline of six tasks. It just calls these intermediate tasks like <code>compile:get-source-paths</code>, <code>compile:get-dependency-graph</code>, and <code>compile:build-artifacts</code>. We recommend prefixing intermediate tasks with their main task and a colon.</p> <p>The problem with this approach is that help messages would be cluttered with lots of uninteresting intermediate tasks. To avoid this, you can define those using the <a href><code>internalTask</code> config DSL function</a>. The <code>internalTask</code> function works almost exactly like <code>task</code>. Its only difference is that tasks defined with it won't be included in help messages.</p> <h2 id="the-buidler-runtime-environment"><a href="#the-buidler-runtime-environment" aria-hidden="true" class="header-anchor">#</a> The Buidler Runtime Environment</h2> <p>The Buidler Runtime Environment is an object containing all the functionality that Buidler exposes when running a task, test and script.</p> <p>By default, the Buidler Runtime Environment gives you programmatic access to the task runner and the config system, and exports an <a href>EIP1193-compatible</a> Ethereum provider. You can find more information about <a href>it in its API docs</a>.</p> <p>Plugins can extend the Buidler Runtime Environment. For example, <a href="https://github.com/nomiclabs/buidler-web3" target="_blank" rel="noopener noreferrer">buidler-web3<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> adds a <code>web3</code> instance to it, making it available to tasks, tests and scripts.</p> <h3 id="globally-exported-buidler-runtime-environment"><a href="#globally-exported-buidler-runtime-environment" aria-hidden="true" class="header-anchor">#</a> Globally exported Buidler Runtime Environment</h3> <p>Before running a task, test or script, Buidler injects the Buidler Runtime Environment into the global scope, turning all of its fields into global variables. When the task execution is completed, these global variables are removed, restoring their original value, if any.</p> <h3 id="explicitly-importing-the-buidler-runtime-environment"><a href="#explicitly-importing-the-buidler-runtime-environment" aria-hidden="true" class="header-anchor">#</a> Explicitly importing the Buidler Runtime Environment</h3> <p>Not everyone likes magic global variables, and Buidler doesn't force you to use them. Everything can be done explicitly in tasks, tests and scripts.</p> <p>You can <a href>import the config DSL</a> explicitly when defining your tasks, and receive the Buidler Runtime Environment explicitly as an argument to your actions. You can read more about this in <a href>Creating your own tasks</a>.</p> <p>When writing tests or scripts, you can use <code>require(&quot;@nomiclabs/buidler&quot;)</code> to import the Buidler Runtime Environment. You can read more about this in <a href>Accessing the Buidler Runtime Environment</a>.</p> <h3 id="extending-the-buidler-runtime-environment"><a href="#extending-the-buidler-runtime-environment" aria-hidden="true" class="header-anchor">#</a> Extending the Buidler Runtime Environment</h3> <p>The Buidler Runtime Environment only provides the core functionality that users and plugin developers need to start building on top of. Using them directly can be somewhat harder than expected.</p> <p>Everything gets easier if you use higher-level libraries, like <a href>web3.js</a> or <a href>truffle-contract</a>, but this libraries need some initialization to work, and that could get repetitive.</p> <p>Buidler lets you hook into the Buidler Runtime Environment construction, and extend it with new functionality. This way, you only have to initialize everything once, and your new features or libraries will be available everywhere the Buidler Runtime Environment is used.</p> <p>You can do this by adding a Buidler Runtime Environment extender into a queue. This extender is just a synchronous function that receives the Buidler Runtime Environment, and adds fields to it with your new functionality. These new fields will also get <a href>injected into the global scope during runtime</a>.</p> <p>For example, adding an instance of Web3.js to the Buidler Runtime Environment can be done in this way:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">extendEnvironment</span><span class="token punctuation">(</span>env <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  env<span class="token punctuation">.</span>Web3 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;web3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// env.ethereum is the EIP1193-compatible provider.</span>
  env<span class="token punctuation">.</span>web3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">env<span class="token punctuation">.</span>Web3</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Web3HTTPProviderAdapter</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>ethereum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="accessing-the-buidler-runtime-environment-from-outside-a-task"><a href="#accessing-the-buidler-runtime-environment-from-outside-a-task" aria-hidden="true" class="header-anchor">#</a> Accessing the Buidler Runtime Environment from outside a task</h3> <p>The Buidler Runtime Environment can be used from any Javascript or TypeScript file. To do so, you only have to import it with <code>require(&quot;@nomiclabs/buidler&quot;)</code>. You can do this to keep more control over your development workflow, create your own tools, or to use Buidler with other dev tools from the node.js ecosystem.</p> <p>Running test directly with <a href>mocha</a> instead of <code>npx buidler test</code> can be done by explicitly importing the Buidler Runtime Environment in them like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> env <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@nomiclabs/buidler&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;assert&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;Buidler Runtime Environment&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;should have a config field&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    assert<span class="token punctuation">.</span><span class="token function">notEqual</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>config<span class="token punctuation">,</span> undefined<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This way, tests written for Buidler are just normal mocha tests. This enables you to run them from your favorite editor without the need of any Buidler-specific plugin. For example, you can run them from Visual Studio Code using <a href="https://marketplace.visualstudio.com/items?itemName=maty.vscode-mocha-sidebar" target="_blank" rel="noopener noreferrer">Mocha sidebar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/nomiclabs/buidler/edit/master/docs/documentation/advanced/architecture.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">3/3/2019, 9:17:21 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.c7fa6efc.js" defer></script><script src="/assets/js/34.1694e862.js" defer></script>
  </body>
</html>
